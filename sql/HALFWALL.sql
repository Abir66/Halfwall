/*
 Navicat Premium Data Transfer

 Source Server         : halfwall
 Source Server Type    : Oracle
 Source Server Version : 190000
 Source Host           : localhost:1521
 Source Schema         : HALFWALL

 Target Server Type    : Oracle
 Target Server Version : 190000
 File Encoding         : 65001

 Date: 23/07/2022 05:08:55
*/


-- ----------------------------
-- Table structure for FOLLOWS
-- ----------------------------
DROP TABLE "HALFWALL"."FOLLOWS";
CREATE TABLE "HALFWALL"."FOLLOWS" (
  "FOLLOWER_ID" NUMBER VISIBLE NOT NULL,
  "FOLLOWEE_ID" NUMBER VISIBLE NOT NULL,
  "TIMESTAMP" TIMESTAMP(6) VISIBLE
)
LOGGING
NOCOMPRESS
PCTFREE 10
INITRANS 1
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  FREELISTS 1
  FREELIST GROUPS 1
  BUFFER_POOL DEFAULT
)
PARALLEL 1
NOCACHE
DISABLE ROW MOVEMENT
;

-- ----------------------------
-- Records of FOLLOWS
-- ----------------------------
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('1', '2', NULL);
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('1', '3', NULL);
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('2', '3', NULL);
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('3', '1', NULL);
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('3', '4', NULL);
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('1', '4', TO_TIMESTAMP('2022-07-21 11:31:01.232000', 'SYYYY-MM-DD HH24:MI:SS:FF6'));
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('2', '1', NULL);
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('4', '1', NULL);
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('4', '2', NULL);
INSERT INTO "HALFWALL"."FOLLOWS" VALUES ('4', '3', NULL);

-- ----------------------------
-- Table structure for FOLLOW_REQUESTS
-- ----------------------------
DROP TABLE "HALFWALL"."FOLLOW_REQUESTS";
CREATE TABLE "HALFWALL"."FOLLOW_REQUESTS" (
  "FOLLOWER_ID" NUMBER VISIBLE NOT NULL,
  "FOLLOWEE_ID" NUMBER VISIBLE NOT NULL,
  "TIMESTAMP" TIMESTAMP(6) VISIBLE
)
LOGGING
NOCOMPRESS
PCTFREE 10
INITRANS 1
STORAGE (
  BUFFER_POOL DEFAULT
)
PARALLEL 1
NOCACHE
DISABLE ROW MOVEMENT
;

-- ----------------------------
-- Records of FOLLOW_REQUESTS
-- ----------------------------

-- ----------------------------
-- Table structure for GROUPS
-- ----------------------------
DROP TABLE "HALFWALL"."GROUPS";
CREATE TABLE "HALFWALL"."GROUPS" (
  "GROUP_ID" NUMBER VISIBLE NOT NULL,
  "GROUP_NAME" VARCHAR2(255 BYTE) VISIBLE NOT NULL,
  "GROUP_PRIVACY" VARCHAR2(20 BYTE) VISIBLE
)
LOGGING
NOCOMPRESS
PCTFREE 10
INITRANS 1
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  FREELISTS 1
  FREELIST GROUPS 1
  BUFFER_POOL DEFAULT
)
PARALLEL 1
NOCACHE
DISABLE ROW MOVEMENT
;

-- ----------------------------
-- Records of GROUPS
-- ----------------------------
INSERT INTO "HALFWALL"."GROUPS" VALUES ('1', 'PERSONAL-PUBLIC', 'SPECIAL');
INSERT INTO "HALFWALL"."GROUPS" VALUES ('2', 'PERSONAL_PRIVATE', 'SPECIAL');

-- ----------------------------
-- Table structure for LIKES
-- ----------------------------
DROP TABLE "HALFWALL"."LIKES";
CREATE TABLE "HALFWALL"."LIKES" (
  "USER_ID" NUMBER VISIBLE NOT NULL,
  "POST_ID" NUMBER VISIBLE NOT NULL,
  "TIMESTAMP" TIMESTAMP(6) VISIBLE
)
LOGGING
NOCOMPRESS
PCTFREE 10
INITRANS 1
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  FREELISTS 1
  FREELIST GROUPS 1
  BUFFER_POOL DEFAULT
)
PARALLEL 1
NOCACHE
DISABLE ROW MOVEMENT
;

-- ----------------------------
-- Records of LIKES
-- ----------------------------
INSERT INTO "HALFWALL"."LIKES" VALUES ('1', '7', TO_TIMESTAMP('2022-07-23 05:04:22.009000', 'SYYYY-MM-DD HH24:MI:SS:FF6'));
INSERT INTO "HALFWALL"."LIKES" VALUES ('1', '9', TO_TIMESTAMP('2022-07-23 05:04:33.283000', 'SYYYY-MM-DD HH24:MI:SS:FF6'));
INSERT INTO "HALFWALL"."LIKES" VALUES ('1', '3', TO_TIMESTAMP('2022-07-23 05:04:44.182000', 'SYYYY-MM-DD HH24:MI:SS:FF6'));

-- ----------------------------
-- Table structure for POSTS
-- ----------------------------
DROP TABLE "HALFWALL"."POSTS";
CREATE TABLE "HALFWALL"."POSTS" (
  "POST_ID" NUMBER VISIBLE NOT NULL,
  "USER_ID" NUMBER VISIBLE NOT NULL,
  "GROUP_ID" NUMBER VISIBLE,
  "DESCRIPTION" VARCHAR2(2000 BYTE) VISIBLE,
  "TIMESTAMP" TIMESTAMP(6) VISIBLE
)
LOGGING
NOCOMPRESS
PCTFREE 10
INITRANS 1
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  FREELISTS 1
  FREELIST GROUPS 1
  BUFFER_POOL DEFAULT
)
PARALLEL 1
NOCACHE
DISABLE ROW MOVEMENT
;

-- ----------------------------
-- Records of POSTS
-- ----------------------------
INSERT INTO "HALFWALL"."POSTS" VALUES ('1', '1', '1', 'Abir post 1', NULL);
INSERT INTO "HALFWALL"."POSTS" VALUES ('2', '1', '1', 'Abir post 2', NULL);
INSERT INTO "HALFWALL"."POSTS" VALUES ('3', '1', '2', 'Abir post 3', NULL);
INSERT INTO "HALFWALL"."POSTS" VALUES ('4', '2', '1', 'Sakib post public', NULL);
INSERT INTO "HALFWALL"."POSTS" VALUES ('5', '2', '2', 'sakib private', NULL);
INSERT INTO "HALFWALL"."POSTS" VALUES ('6', '3', '1', 'lara public', NULL);
INSERT INTO "HALFWALL"."POSTS" VALUES ('7', '3', '2', 'lara private', NULL);
INSERT INTO "HALFWALL"."POSTS" VALUES ('8', '4', '1', 'saad public', NULL);
INSERT INTO "HALFWALL"."POSTS" VALUES ('9', '4', '2', 'saad private', NULL);

-- ----------------------------
-- Table structure for USERS
-- ----------------------------
DROP TABLE "HALFWALL"."USERS";
CREATE TABLE "HALFWALL"."USERS" (
  "USER_ID" NUMBER VISIBLE NOT NULL,
  "STUDENT_ID" NUMBER VISIBLE NOT NULL,
  "NAME" VARCHAR2(255 BYTE) VISIBLE NOT NULL,
  "EMAIL" VARCHAR2(255 BYTE) VISIBLE NOT NULL,
  "PASSWORD" VARCHAR2(255 BYTE) VISIBLE NOT NULL,
  "DEPARTMENT" VARCHAR2(255 BYTE) VISIBLE,
  "DATE_OF_BIRTH" DATE VISIBLE,
  "HALL" VARCHAR2(255 BYTE) VISIBLE,
  "HALL_ATTACHMENT" CHAR(1 BYTE) VISIBLE,
  "BATCH" NUMBER VISIBLE,
  "PROFILE_PIC" VARCHAR2(255 BYTE) VISIBLE,
  "STREET" VARCHAR2(255 BYTE) VISIBLE,
  "CITY" VARCHAR2(255 BYTE) VISIBLE,
  "POSTCODE" NUMBER VISIBLE
)
LOGGING
NOCOMPRESS
PCTFREE 10
INITRANS 1
STORAGE (
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1
  MAXEXTENTS 2147483645
  FREELISTS 1
  FREELIST GROUPS 1
  BUFFER_POOL DEFAULT
)
PARALLEL 1
NOCACHE
DISABLE ROW MOVEMENT
;

-- ----------------------------
-- Records of USERS
-- ----------------------------
INSERT INTO "HALFWALL"."USERS" VALUES ('1', '1905066', 'ABIR MUHTASIM', 'auntor505@gmail.com', '1234', 'CSE', NULL, NULL, 'A', '2019', NULL, 'FARIDPUR GORSTAN MON', 'DINAJPUR', NULL);
INSERT INTO "HALFWALL"."USERS" VALUES ('2', '1905061', 'NAZMUS SAKIB', 'sakib@gmail.com', '1234', 'CSE', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO "HALFWALL"."USERS" VALUES ('3', '1905062', 'LARA KHAN', 'lara@yahoo.com', '1234', 'CSE', NULL, 'CHAATTRI', 'R', NULL, NULL, NULL, NULL, NULL);
INSERT INTO "HALFWALL"."USERS" VALUES ('4', '1905090', 'TANVIR SAAD', 'saad@gmail.com', '1234', 'CSE', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);

-- ----------------------------
-- Function structure for CREATE_USER
-- ----------------------------
CREATE OR REPLACE
PROCEDURE "HALFWALL"."CREATE_USER" AS
BEGIN
	NEW_USER_ID := USER_SEQ.NEXTVAL;
	INSERT INTO USERS
	VALUES  (NEW_USER_ID, NEW_STUDENT_ID, UPPER(NEW_NAME), LOWER(NEW_EMAIL), NEW_PASSWORD, UPPER(NEW_DEPARTMENT), NEW_DATE_OF_BIRTH, UPPER(NEW_HALL), UPPER(NEW_HALL_ATTACHMENT), NEW_BATCH, NEW_PROFILE_PIC, UPPER(NEW_STREET), UPPER(NEW_CITY), NEW_POSTCODE );

	RESULT := NEW_USER_ID;

	EXCEPTION
    WHEN DUP_VAL_ON_INDEX THEN
        RESULT := 'Student ID or email already exists';
    WHEN OTHERS THEN
        RESULT := 'Something went wrong';
END;
/

-- ----------------------------
-- Function structure for UPDATE_USER
-- ----------------------------
CREATE OR REPLACE
PROCEDURE "HALFWALL"."UPDATE_USER" AS
BEGIN
	    UPDATE USERS
      SET
				STUDENT_ID = NEW_STUDENT_ID,
        NAME = UPPER(NEW_NAME),
		    EMAIL = LOWER(NEW_EMAIL),
				PASSWORD = NEW_PASSWORD,
		    DATE_OF_BIRTH = TO_DATE(NEW_DATE_OF_BIRTH,'YYYY-MM-DD'),
         HALL = UPPER(NEW_HALL),
		    HALL_ATTACHMENT = UPPER(NEW_HALL_ATTACHMENT),
		    STREET = UPPER(NEW_STREET),
		    CITY = UPPER(NEW_CITY),
				POSTCODE = NEW_POSTCODE
                    
        WHERE USER_ID = NEW_USER_ID;
				
				RESULT := 'success';

	EXCEPTION
    WHEN DUP_VAL_ON_INDEX THEN
        RESULT := 'Student ID or email already exists';
    WHEN OTHERS THEN
        RESULT := 'Something went wrong';
END;
/

-- ----------------------------
-- Sequence structure for USER_SEQ
-- ----------------------------
DROP SEQUENCE "HALFWALL"."USER_SEQ";
CREATE SEQUENCE "HALFWALL"."USER_SEQ" MINVALUE 5 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 CACHE 20;

-- ----------------------------
-- Primary Key structure for table FOLLOWS
-- ----------------------------
ALTER TABLE "HALFWALL"."FOLLOWS" ADD CONSTRAINT "SYS_C007445" PRIMARY KEY ("FOLLOWER_ID", "FOLLOWEE_ID");

-- ----------------------------
-- Checks structure for table FOLLOWS
-- ----------------------------
ALTER TABLE "HALFWALL"."FOLLOWS" ADD CONSTRAINT "SYS_C007443" CHECK ("FOLLOWER_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."FOLLOWS" ADD CONSTRAINT "SYS_C007444" CHECK ("FOLLOWEE_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."FOLLOWS" ADD CONSTRAINT "SYS_C007488" CHECK ("FOLLOWER_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."FOLLOWS" ADD CONSTRAINT "SYS_C007489" CHECK ("FOLLOWEE_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Primary Key structure for table FOLLOW_REQUESTS
-- ----------------------------
ALTER TABLE "HALFWALL"."FOLLOW_REQUESTS" ADD CONSTRAINT "SYS_C007564" PRIMARY KEY ("FOLLOWER_ID", "FOLLOWEE_ID");

-- ----------------------------
-- Checks structure for table FOLLOW_REQUESTS
-- ----------------------------
ALTER TABLE "HALFWALL"."FOLLOW_REQUESTS" ADD CONSTRAINT "SYS_C007562" CHECK ("FOLLOWER_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."FOLLOW_REQUESTS" ADD CONSTRAINT "SYS_C007563" CHECK ("FOLLOWEE_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Primary Key structure for table GROUPS
-- ----------------------------
ALTER TABLE "HALFWALL"."GROUPS" ADD CONSTRAINT "SYS_C007549" PRIMARY KEY ("GROUP_ID");

-- ----------------------------
-- Checks structure for table GROUPS
-- ----------------------------
ALTER TABLE "HALFWALL"."GROUPS" ADD CONSTRAINT "SYS_C007547" CHECK ("GROUP_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."GROUPS" ADD CONSTRAINT "SYS_C007548" CHECK ("GROUP_NAME" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Primary Key structure for table LIKES
-- ----------------------------
ALTER TABLE "HALFWALL"."LIKES" ADD CONSTRAINT "SYS_C007559" PRIMARY KEY ("USER_ID", "POST_ID");

-- ----------------------------
-- Checks structure for table LIKES
-- ----------------------------
ALTER TABLE "HALFWALL"."LIKES" ADD CONSTRAINT "SYS_C007556" CHECK ("USER_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."LIKES" ADD CONSTRAINT "SYS_C007557" CHECK ("POST_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Primary Key structure for table POSTS
-- ----------------------------
ALTER TABLE "HALFWALL"."POSTS" ADD CONSTRAINT "SYS_C007553" PRIMARY KEY ("POST_ID");

-- ----------------------------
-- Checks structure for table POSTS
-- ----------------------------
ALTER TABLE "HALFWALL"."POSTS" ADD CONSTRAINT "SYS_C007551" CHECK ("POST_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."POSTS" ADD CONSTRAINT "SYS_C007552" CHECK ("USER_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Primary Key structure for table USERS
-- ----------------------------
ALTER TABLE "HALFWALL"."USERS" ADD CONSTRAINT "SYS_C007529" PRIMARY KEY ("USER_ID");

-- ----------------------------
-- Uniques structure for table USERS
-- ----------------------------
ALTER TABLE "HALFWALL"."USERS" ADD CONSTRAINT "UNQ_EMAIL" UNIQUE ("EMAIL") NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."USERS" ADD CONSTRAINT "UNQ_STUDENT_ID" UNIQUE ("STUDENT_ID") NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Checks structure for table USERS
-- ----------------------------
ALTER TABLE "HALFWALL"."USERS" ADD CONSTRAINT "SYS_C007524" CHECK ("USER_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."USERS" ADD CONSTRAINT "SYS_C007525" CHECK ("STUDENT_ID" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."USERS" ADD CONSTRAINT "SYS_C007526" CHECK ("NAME" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."USERS" ADD CONSTRAINT "SYS_C007527" CHECK ("EMAIL" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."USERS" ADD CONSTRAINT "SYS_C007528" CHECK ("PASSWORD" IS NOT NULL) NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Foreign Keys structure for table FOLLOWS
-- ----------------------------
ALTER TABLE "HALFWALL"."FOLLOWS" ADD CONSTRAINT "FOLLOWS_FK1" FOREIGN KEY ("FOLLOWER_ID") REFERENCES "HALFWALL"."USERS" ("USER_ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."FOLLOWS" ADD CONSTRAINT "FOLLOWS_FK2" FOREIGN KEY ("FOLLOWEE_ID") REFERENCES "HALFWALL"."USERS" ("USER_ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Foreign Keys structure for table FOLLOW_REQUESTS
-- ----------------------------
ALTER TABLE "HALFWALL"."FOLLOW_REQUESTS" ADD CONSTRAINT "FOLLOW_REQ_FK1" FOREIGN KEY ("FOLLOWER_ID") REFERENCES "HALFWALL"."USERS" ("USER_ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."FOLLOW_REQUESTS" ADD CONSTRAINT "FOLLOW_REQ_FK2" FOREIGN KEY ("FOLLOWEE_ID") REFERENCES "HALFWALL"."USERS" ("USER_ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Foreign Keys structure for table LIKES
-- ----------------------------
ALTER TABLE "HALFWALL"."LIKES" ADD CONSTRAINT "LIKES_PK1" FOREIGN KEY ("USER_ID") REFERENCES "HALFWALL"."USERS" ("USER_ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."LIKES" ADD CONSTRAINT "LIKES_PK2" FOREIGN KEY ("POST_ID") REFERENCES "HALFWALL"."POSTS" ("POST_ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;

-- ----------------------------
-- Foreign Keys structure for table POSTS
-- ----------------------------
ALTER TABLE "HALFWALL"."POSTS" ADD CONSTRAINT "POSTS_PK1" FOREIGN KEY ("USER_ID") REFERENCES "HALFWALL"."USERS" ("USER_ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
ALTER TABLE "HALFWALL"."POSTS" ADD CONSTRAINT "POSTS_PK2" FOREIGN KEY ("GROUP_ID") REFERENCES "HALFWALL"."GROUPS" ("GROUP_ID") ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE NORELY VALIDATE;
